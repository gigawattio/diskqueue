NB: Initial implementation lifted from NSQ, see https://github.com/nsqio/nsq/
and https://github.com/nsqio/nsq/blob/master/nsqd/diskqueue.go.
